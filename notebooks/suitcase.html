<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Example Suitcase Export Script &mdash; NSLS-II CSX Beamline Docs 0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.2.0/united/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="NSLS-II CSX Beamline Docs 0.1 documentation" href="../index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">
  
  <a href="https://github.com/NSLS-II-CSX/csxtools"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          NSLS-II CSX Beamline Docs</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../csx-1/index.html">CSX-1 (23-ID-1) Beamline Doccumentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/index.html">Guides and Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../csxtools/index.html">CSXTOOLS Doccumentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Example Notebooks</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Example Suitcase Export Script</a></li>
<li><a class="reference internal" href="#ipython-notebook-to-export-csx-data-as-a-suitcase">iPython Notebook To Export CSX Data as a suitcase</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Example Suitcase Export Script</a></li>
<li><a class="reference internal" href="#ipython-notebook-to-export-csx-data-as-a-suitcase">iPython Notebook To Export CSX Data as a suitcase</a></li>
</ul>

<div id="sourcelink">
  <a href="../_sources/notebooks/suitcase.txt"
     rel="nofollow">Source</a>
</div>
<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9">
      
  <div class="section" id="example-suitcase-export-script">
<h1>Example Suitcase Export Script<a class="headerlink" href="#example-suitcase-export-script" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="ipython-notebook-to-export-csx-data-as-a-suitcase">
<h1>iPython Notebook To Export CSX Data as a suitcase<a class="headerlink" href="#ipython-notebook-to-export-csx-data-as-a-suitcase" title="Permalink to this headline">¶</a></h1>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">dataportal</span> <span class="kn">import</span> <span class="n">DataBroker</span> <span class="k">as</span> <span class="n">db</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">suitcase</span> <span class="kn">import</span> <span class="n">export</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">FILENAME</span> <span class="o">=</span> <span class="s">&#39;scan-&#39;</span>  <span class="c"># no file extension; we take care of that below</span>
<span class="n">SCAN_ID</span> <span class="o">=</span> <span class="mi">52326</span>
<span class="n">START</span> <span class="o">=</span>  <span class="n">SCAN_ID</span>
<span class="n">STOP</span> <span class="o">=</span> <span class="mi">52329</span>
<span class="n">OVERWRITE</span> <span class="o">=</span> <span class="bp">True</span>  <span class="c"># If true, I will delete the file FILENAME if it exists.</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre># sanity check that we can see the GPFS. If this fails, give up and email Rob Petkus. There is no hope.
!ls &#39;/GPFS/&#39;
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">xf23id</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">h</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="n">SCAN_ID</span><span class="p">]</span>
<span class="n">h</span>
</pre></div>
</div>
<table>

  <tr>
    <th> descriptors </th>
    <td>


            [{'uid': 'affcd928-f16d-4d1a-b91b-36d9a5229d76', '_name': 'EventDescriptor', 'time': 1444989136.6295948, 'run_start': '8c293b62-b015-42a9-bcf5-77daeadc205f', 'data_keys': {'npty': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Dif:Lens-Ax:TopY}Mtr.RBV'}, 'fccd_image_lightfield': {'shape': [100, 960, 960], 'dtype': 'array', 'external': 'FILESTORE:', 'source': 'PV:XF:23ID1-ES{FCCD}'}, 'fccd_stats_total3': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{FCCD}Stats3:Total_RBV'}, 'theta': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Dif-Ax:Th}Mtr.RBV'}, 'sclr_chan4': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Sclr:1}.S4'}, 'sclr_chan1': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Sclr:1}.S1'}, 'temp_b': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{TCtrl:1-Chan:B}T-I'}, 'sclr_chan3': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Sclr:1}.S3'}, 'npbz': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Dif:Lens-Ax:BtmZ}Mtr.RBV'}, 'pgm_energy': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-OP{Mono}Enrgy-I'}, 'sy': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Dif-Ax:SY}Pos-RB'}, 'fccd_acquire_time': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{FCCD}cam1:AcquireTime_RBV'}, 'npby': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Dif:Lens-Ax:BtmY}Mtr.RBV'}, 'sclr_chan7': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Sclr:1}.S7'}, 'delta': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Dif-Ax:Del}Mtr.RBV'}, 'sz': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Dif-Ax:SZ}Pos-RB'}, 'fccd_acquire_period': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{FCCD}cam1:AcquirePeriod_RBV'}, 'say': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Dif-Ax:Y}Mtr.RBV'}, 'epu2_phase': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID-ID{EPU:2-Ax:Phase}Pos-I'}, 'nptx': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Dif:Lens-Ax:TopX}Mtr.RBV'}, 'sclr_chan6': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Sclr:1}.S6'}, 'eta': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Diag:1-Ax:Eta}Mtr.RBV'}, 'nptz': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Dif:Lens-Ax:TopZ}Mtr.RBV'}, 'sclr_chan5': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Sclr:1}.S5'}, 'sclr_time': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Sclr:1}.T'}, 'gamma': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Dif-Ax:Gam}Mtr.RBV'}, 'sclr_chan2': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Sclr:1}.S2'}, 'fccd_stats_total4': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{FCCD}Stats4:Total_RBV'}, 'temp_a': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{TCtrl:1-Chan:A}T-I'}, 'epu2_gap': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID-ID{EPU:2-Ax:Gap}Pos-I'}, 'fccd_stats_total5': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{FCCD}Stats5:Total_RBV'}, 'ring_curr': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID-SR{}I-I'}, 'sclr_chan8': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Sclr:1}.S8'}, 'fccd_stats_total2': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{FCCD}Stats2:Total_RBV'}, 'fccd_stats_total1': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{FCCD}Stats1:Total_RBV'}, 'sx': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Dif-Ax:X}Mtr.RBV'}, 'saz': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Dif-Ax:Z}Mtr.RBV'}, 'npbx': {'shape': [], 'dtype': 'number', 'source': 'PV:XF:23ID1-ES{Dif:Lens-Ax:BtmX}Mtr.RBV'}}}]


    </td>
  </tr>

  <tr>
    <th> start </th>
    <td>

        <table>

  <tr>
    <th> beamline_id </th>
    <td>


            CSX


    </td>
  </tr>

  <tr>
    <th> config </th>
    <td>

        <table>

        </table>

    </td>
  </tr>

  <tr>
    <th> group </th>
    <td>





    </td>
  </tr>

  <tr>
    <th> owner </th>
    <td>


            xf23id1


    </td>
  </tr>

  <tr>
    <th> project </th>
    <td>





    </td>
  </tr>

  <tr>
    <th> sample </th>
    <td>

        <table>

        </table>

    </td>
  </tr>

  <tr>
    <th> scan_args </th>
    <td>

        <table>

  <tr>
    <th> delay </th>
    <td>


            0


    </td>
  </tr>

  <tr>
    <th> detectors </th>
    <td>


            [EpicsMotor(name='theta', record='XF:23ID1-ES{Dif-Ax:Th}Mtr'), EpicsMotor(name='delta', record='XF:23ID1-ES{Dif-Ax:Del}Mtr'), EpicsMotor(name='gamma', record='XF:23ID1-ES{Dif-Ax:Gam}Mtr'), EpicsMotor(name='sx', record='XF:23ID1-ES{Dif-Ax:X}Mtr'), PVPositioner(name='sy', setpoint='XF:23ID1-ES{Dif-Ax:SY}Pos-SP', readback='XF:23ID1-ES{Dif-Ax:SY}Pos-RB', stop='XF:23ID1-ES{Dif-Cryo}Cmd:Stop-Cmd', stop_val=1, put_complete=True, settle_time=0.05, limits=(0, 0)), PVPositioner(name='sz', setpoint='XF:23ID1-ES{Dif-Ax:SZ}Pos-SP', readback='XF:23ID1-ES{Dif-Ax:SZ}Pos-RB', stop='XF:23ID1-ES{Dif-Cryo}Cmd:Stop-Cmd', stop_val=1, put_complete=True, settle_time=0.05, limits=(0, 0)), EpicsMotor(name='say', record='XF:23ID1-ES{Dif-Ax:Y}Mtr'), EpicsMotor(name='saz', record='XF:23ID1-ES{Dif-Ax:Z}Mtr'), EpicsSignal(name='temp_a', read_pv='XF:23ID1-ES{TCtrl:1-Chan:A}T-I', rw=False, string=False, limits=False, put_complete=False, pv_kw={}, auto_monitor=None), EpicsSignal(name='temp_b', read_pv='XF:23ID1-ES{TCtrl:1-Chan:B}T-I', rw=False, string=False, limits=False, put_complete=False, pv_kw={}, auto_monitor=None), PVPositioner(name='pgm_energy', setpoint='XF:23ID1-OP{Mono}Enrgy-SP', readback='XF:23ID1-OP{Mono}Enrgy-I', stop='XF:23ID1-OP{Mono}Cmd:Stop-Cmd', stop_val=1, put_complete=True, settle_time=0.05, limits=(200, 2200)), PVPositioner(name='epu2_gap', setpoint='XF:23ID-ID{EPU:2-Ax:Gap}Pos-SP', readback='XF:23ID-ID{EPU:2-Ax:Gap}Pos-I', stop='SR:C23-ID:G1A{EPU:2-Ax:Gap}-Mtr.STOP', stop_val=1, put_complete=True, settle_time=0.05, limits=(0, 0)), EpicsSignal(name='ring_curr', read_pv='XF:23ID-SR{}I-I', rw=False, string=False, limits=False, put_complete=False, pv_kw={}, auto_monitor=None), EpicsMotor(name='npbx', record='XF:23ID1-ES{Dif:Lens-Ax:BtmX}Mtr'), EpicsMotor(name='npby', record='XF:23ID1-ES{Dif:Lens-Ax:BtmY}Mtr'), EpicsMotor(name='npbz', record='XF:23ID1-ES{Dif:Lens-Ax:BtmZ}Mtr'), EpicsMotor(name='nptx', record='XF:23ID1-ES{Dif:Lens-Ax:TopX}Mtr'), EpicsMotor(name='npty', record='XF:23ID1-ES{Dif:Lens-Ax:TopY}Mtr'), EpicsMotor(name='nptz', record='XF:23ID1-ES{Dif:Lens-Ax:TopZ}Mtr'), EpicsScaler(name='sclr', record='XF:23ID1-ES{Sclr:1}', numchan=8), PVPositioner(name='epu2_phase', setpoint='XF:23ID-ID{EPU:2-Ax:Phase}Pos-SP', readback='XF:23ID-ID{EPU:2-Ax:Phase}Pos-I', stop='SR:C23-ID:G1A{EPU:2-Ax:Phase}-Mtr.STOP', stop_val=1, put_complete=True, settle_time=0.05, limits=(0, 0)), EpicsMotor(name='eta', record='XF:23ID1-ES{Diag:1-Ax:Eta}Mtr'), AreaDetectorFileStoreHDF5(name='fccd', basename='XF:23ID1-ES{FCCD}', stats=[1, 2, 3, 4, 5], shutter=None, shutter_rb=None, shutter_val=None, file_path='/GPFS/xf23id/xf23id1/fccd_data/', ioc_file_path=None)]


    </td>
  </tr>

  <tr>
    <th> num </th>
    <td>


            1


    </td>
  </tr>

        </table>

    </td>
  </tr>

  <tr>
    <th> scan_id </th>
    <td>


            52326


    </td>
  </tr>

  <tr>
    <th> scan_type </th>
    <td>


            Count


    </td>
  </tr>

  <tr>
    <th> time </th>
    <td>


            a month ago (2015-10-16T05:48:38.831460)


    </td>
  </tr>

  <tr>
    <th> uid </th>
    <td>


            8c293b62-b015-42a9-bcf5-77daeadc205f


    </td>
  </tr>

        </table>

    </td>
  </tr>

  <tr>
    <th> stop </th>
    <td>

        <table>

  <tr>
    <th> exit_status </th>
    <td>


            success


    </td>
  </tr>

  <tr>
    <th> reason </th>
    <td>





    </td>
  </tr>

  <tr>
    <th> run_start </th>
    <td>


            8c293b62-b015-42a9-bcf5-77daeadc205f


    </td>
  </tr>

  <tr>
    <th> time </th>
    <td>


            a month ago (2015-10-16T05:52:17.810649)


    </td>
  </tr>

  <tr>
    <th> uid </th>
    <td>


            b531b74e-4895-4e6c-8eed-a67b8c6bd67c


    </td>
  </tr>

        </table>

    </td>
  </tr>

</table><div class="code python highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">SCAN_ID</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">START</span><span class="p">,</span><span class="n">STOP</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="n">SCAN_ID</span><span class="p">]</span>
    <span class="n">SCANNUMBER</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">SCAN_ID</span><span class="p">)</span>
    <span class="n">fn</span> <span class="o">=</span> <span class="s">&#39;{filename}.h5&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">FILENAME</span><span class="o">+</span><span class="n">SCANNUMBER</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">OVERWRITE</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;That file already exists. Set OVERWRITE = True if you want to overwrite.&quot;</span><span class="p">)</span>
    <span class="n">export</span><span class="p">([</span><span class="n">h</span><span class="p">],</span> <span class="n">fn</span><span class="p">)</span>
</pre></div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/notebooks/suitcase.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2015, Brookhaven Science Associates, Brookhaven National Lab..<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>